---
import Badge from "@/components/ui/Badge.astro";
import SocialPill from "@/components/ui/SocialPill.astro";
import LinkedInIcon from "@/components/icons/LinkedIn.astro";
import GitHubIcon from "@/components/icons/GitHub.astro";
import MailIcon from "@/components/icons/Mail.astro";
import HackerRank from "@/components/icons/HackerRank.astro";
import SectionContainer from "@/components/sections/SectionConteiner.astro";
import NodeJsIcon from "../icons/NodeJsIcon.astro";
import Aws from "../icons/Aws.astro";
import Typescript from "../icons/Typescript.astro";
import Docker from "../icons/Docker.astro";
---

<SectionContainer id="home" class="py-20 md:py-28">
    <!-- 1) alineamos arriba -->
    <div class="grid items-start gap-10 md:grid-cols-[1.2fr_.8fr]">
        <!-- Columna texto -->
        <div>
            <div
                class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs tracking-wide uppercase opacity-90 mb-4"
            >
                Backend • Node.js • TypeScript
            </div>

            <h1 class="text-3xl md:text-5xl font-bold leading-tight">
                Construyo backend <span class="text-yellow-300/90"
                    >escalable y medible</span
                > con Node.js & TypeScript.
            </h1>

            <p class="mt-8 text-neutral-300 max-w-prose">
                +3 años creando APIs y microservicios en equipos ágiles. Enfoque
                en buenas prácticas, automatización y performance en producción.
            </p>
        </div>

        <!-- Columna imagen -->
        <div class="justify-self-center self-start">
            <img
                src="/images/gonzalo.webp"
                alt="Foto de Gonzalo Fernández"
                class="object-cover w-56 md:w-64 lg:w-72 aspect-square rounded-2xl ring-1 ring-white/20 bg-white/5 mb-2 image-bounce"
                style="object-position: 50% 50%"
                loading="eager"
                decoding="async"
            />
            <p class="text-xs text-neutral-400 text-center">
                San Cayetano, Argentina
            </p>

            <!-- CTAs -->
            <div class="mt-7 flex flex-wrap gap-3">
                <a
                    href="#contact"
                    class="rounded-xl px-4 py-2 bg-white/10 hover:bg-white/15 transition"
                    >Hablemos</a
                >

                <a href="/Gonzalo_Fernandez_CV.pdf" download>
                    <Badge>Download CV</Badge>
                </a>

                <a
                    href="#projects"
                    class="rounded-xl px-4 py-2 ring-1 ring-white/10 hover:bg-white/5 transition"
                    >Ver proyectos →</a
                >
            </div>
        </div>

        <!-- HIGHLIGHTS-->
        <ul
            class="mt-8 grid gap-6 sm:grid-cols-2 col-span-full max-w-2xl mx-auto"
        >
            <li class="flex items-start gap-3">
                <NodeJsIcon class="size-10 md:size-12" />
                <span
                    >APIs y microservicios escalables en <strong>Node.js</strong
                    >.</span
                >
            </li>
            <li class="flex items-start gap-3">
                <Typescript class="size-10 md:size-12" />
                <span
                    >Tipado seguro y mantenible con <strong>TypeScript</strong
                    >.</span
                >
            </li>
            <li class="flex items-start gap-3">
                <Aws class="size-10 md:size-12" />
                <span
                    >Automatizaciones en la nube usando <strong
                        >AWS Lambda</strong
                    >.</span
                >
            </li>
            <li class="flex items-start gap-3">
                <Docker class="size-10 md:size-12" />
                <span
                    >Entornos reproducibles y CI/CD con <strong>Docker</strong
                    >.</span
                >
            </li>
        </ul>

        <!-- Social -->
        <nav
            class="mt-8 col-span-full mx-auto max-w-3xl md:max-w-4xl grid grid-flow-col auto-cols-max gap-3 justify-center"
        >
            <SocialPill
                href="https://www.linkedin.com/in/gonzalo-nicolas-fernandez"
                aria-label="LinkedIn"
            >
                <LinkedInIcon class="size-5 md:size-6" aria-hidden="true" /> LinkedIn
            </SocialPill>

            <SocialPill href="https://github.com/CharlyGon" aria-label="GitHub">
                <GitHubIcon class="size-5 md:size-6" aria-hidden="true" /> GitHub
            </SocialPill>

            <SocialPill
                href="https://www.hackerrank.com/profile/GonzaloFernandez"
                aria-label="HackerRank"
            >
                <HackerRank class="size-5 md:size-6" aria-hidden="true" /> HackerRank
            </SocialPill>

            <SocialPill
                data-confetti-copy
                data-copy-value="fernandez-gonza@hotmail.com"
                data-copied-label="¡Copiado!"
                data-confetti="both"
                href="#"
                role="button"
                class="relative overflow-visible select-none"
            >
                <MailIcon class="size-5 md:size-6" aria-hidden="true" />
                <span class="pill-label normal"
                    >fernandez-gonza@hotmail.com</span
                >
                <span class="pill-label copied hidden font-semibold"
                    >¡Copiado!</span
                >
            </SocialPill>
        </nav>

        <div class="mt-6 col-span-full flex justify-center">
            <div
                id="visit-counter"
                class="px-4 py-2 font-mono text-lg tracking-widest text-green-400 bg-black border-2 border-green-500 rounded-md shadow-[inset_0_0_10px_rgba(0,255,0,0.7)]"
                style="font-family:'Press Start 2P',monospace;"
            >
                Visits: <span id="visit-count">00000</span>
            </div>
        </div>
    </div>
</SectionContainer>

<script type="module" src="/scripts/copy-confetti.js"></script>

<script is:inline>
    const el = document.getElementById("visit-count");
    const setCount = (n) =>
        el && (el.textContent = String(n || 0).padStart(5, "0"));

    (async () => {
        const bust = Date.now();
        try {
            const r = await fetch(`/api/visits?up=1&_=${bust}`, {
                headers: { "Cache-Control": "no-store" },
            });
            if (!r.ok) throw new Error("up failed");
            const d = await r.json();
            setCount(d.count);
        } catch {
            try {
                const r2 = await fetch(`/api/visits?_=${bust}`, {
                    headers: { "Cache-Control": "no-store" },
                });
                const d2 = await r2.json();
                setCount(d2.count);
                console.warn("up failed, got count only");
            } catch {
                setCount(1);
            }
        }
    })();
</script>
